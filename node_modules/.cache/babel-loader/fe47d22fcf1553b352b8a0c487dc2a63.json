{"ast":null,"code":"import { toast } from \"react-toastify\";\nimport { postLoginInstance } from \"../../utils\";\nimport { API_LIMIT, START_PAGE } from \"../../utils/Constant\";\nimport { calculateTotalPageCount } from \"../../utils/ReusableFunctions\";\nexport const getAllCouponsApi = function (ctx) {\n  let page = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : START_PAGE;\n  return function (dispatch, getState) {\n    let data = new URLSearchParams();\n    data.append(\"start\", page * API_LIMIT || START_PAGE);\n    data.append(\"limit\", API_LIMIT);\n    data.append(\"conditions\", JSON.stringify(ctx.state.conditions || []));\n    data.append(\"sorts\", JSON.stringify([]));\n    postLoginInstance.post(\"/commerce/coupon/search-coupon\", data).then(res => {\n      ctx.setState({\n        couponList: res.data.data.results,\n        totalCount: res.data.data.total_count,\n        totalPage: calculateTotalPageCount(res.data.data.total_count),\n        page: page\n      });\n    }).catch(err => {\n      console.log(\"Catch\", err);\n    });\n  };\n};\nexport const addEditCouponsApi = (data, cb) => {\n  return postLoginInstance.post(\"/commerce/coupon/add-update-coupon\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      toast.success(res.data.message || \"Something went wrong\");\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    toast.error(err.message || \"Something went wrong\");\n  });\n};\nexport const getApplicableCouponsApi = (data, ctx) => {\n  return postLoginInstance.post(\"/commerce/coupon/get-applicable-coupons\", data).then(res => {\n    if (!res.data.error) {\n      const couponList = res.data.data.results.map(coupon => ({ ...coupon,\n        label: coupon.coupon_code,\n        couponValue: coupon.value,\n        value: coupon.id\n      }));\n      ctx.setState({\n        couponList\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    toast.error(err.message || \"Something went wrong\");\n  });\n};","map":{"version":3,"sources":["/opt/projects/loch-dashboard/src/app/coupons/Api.js"],"names":["toast","postLoginInstance","API_LIMIT","START_PAGE","calculateTotalPageCount","getAllCouponsApi","ctx","page","dispatch","getState","data","URLSearchParams","append","JSON","stringify","state","conditions","post","then","res","setState","couponList","results","totalCount","total_count","totalPage","catch","err","console","log","addEditCouponsApi","cb","error","success","message","getApplicableCouponsApi","map","coupon","label","coupon_code","couponValue","value","id"],"mappings":"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","sourcesContent":["import { toast } from \"react-toastify\"\nimport { postLoginInstance } from \"../../utils\"\nimport { API_LIMIT, START_PAGE } from \"../../utils/Constant\"\nimport { calculateTotalPageCount } from \"../../utils/ReusableFunctions\"\n\nexport const getAllCouponsApi = (ctx, page = START_PAGE) => {\n  return function (dispatch, getState) {\n    let data = new URLSearchParams()\n    data.append(\"start\", page * API_LIMIT || START_PAGE)\n    data.append(\"limit\", API_LIMIT)\n    data.append(\"conditions\", JSON.stringify(ctx.state.conditions || []))\n    data.append(\"sorts\", JSON.stringify([]))\n\n    postLoginInstance\n      .post(\"/commerce/coupon/search-coupon\", data)\n      .then((res) => {\n        ctx.setState({\n          couponList: res.data.data.results,\n          totalCount: res.data.data.total_count,\n          totalPage: calculateTotalPageCount(res.data.data.total_count),\n          page: page\n        })\n      })\n      .catch((err) => {\n        console.log(\"Catch\", err)\n      })\n  }\n}\n\nexport const addEditCouponsApi = (data, cb) => {\n  return postLoginInstance\n    .post(\"/commerce/coupon/add-update-coupon\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        toast.success(res.data.message || \"Something went wrong\")\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      toast.error(err.message || \"Something went wrong\")\n    })\n}\n\nexport const getApplicableCouponsApi = (data, ctx) => {\n  return postLoginInstance\n    .post(\"/commerce/coupon/get-applicable-coupons\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        const couponList = res.data.data.results.map((coupon) => ({\n          ...coupon,\n          label: coupon.coupon_code,\n          couponValue: coupon.value,\n          value: coupon.id\n        }))\n        ctx.setState({ couponList })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      toast.error(err.message || \"Something went wrong\")\n    })\n}\n"]},"metadata":{},"sourceType":"module"}