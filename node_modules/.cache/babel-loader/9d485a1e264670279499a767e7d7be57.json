{"ast":null,"code":"import { toast } from \"react-toastify\";\nimport { postLoginInstance } from \"../../utils\";\nimport { API_LIMIT, START_PAGE } from \"../../utils/Constant\";\nexport const addUpdateCustomerApi = (data, cb) => {\n  postLoginInstance.post(\"/organisation/user/add-update-customer\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      toast.success(res.data.message || \"Something went wrong\");\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    toast.error(err.message || \"Something went wrong\");\n  });\n};\nexport const getAllCustomersApi = function (ctx) {\n  let optionsList = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  let customerInfo = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  console.log(\"customerInfo\", customerInfo);\n  const {\n    searchText,\n    searchKey\n  } = ctx.state;\n  console.log(\"ctx.state.page * API_LIMIT\", ctx.state.page);\n  let data = new URLSearchParams();\n\n  if (optionsList) {\n    data.append(\"start\", -1);\n    data.append(\"limit\", -1);\n  } else {\n    data.append(\"start\", (ctx.state.page - 1) * API_LIMIT || START_PAGE);\n    data.append(\"limit\", API_LIMIT);\n  } // data.append(\"start\", (ctx.state.page - 1) * API_LIMIT);\n  // data.append(\"limit\", API_LIMIT);\n\n\n  data.append(\"conditions\", JSON.stringify(searchText ? [{\n    key: searchKey,\n    value: searchText\n  }] : []));\n  data.append(\"sorts\", JSON.stringify([]));\n  postLoginInstance.post(\"/organisation/user/search-customer\", data).then(res => {\n    if (!res.data.error) {\n      let phoneNumberOptions = res.data.data.results.map(item => ({ ...item,\n        label: item.mobile || \"Null\",\n        value: item.id\n      }));\n      const selectedCustomer = customerInfo ? phoneNumberOptions.filter(item => item.id === customerInfo.user_details.id) : \"\";\n\n      if (optionsList) {\n        ctx.setState({\n          phoneNumberOptions,\n          ...(customerInfo && {\n            customerInfo: customerInfo.user_details,\n            showAddCustomer: false,\n            phoneNumber: customerInfo.user_details.id,\n            selectedCustomer\n          })\n        });\n      } else {\n        ctx.setState({\n          customersList: res.data.data.results,\n          totalPages: Math.ceil(res.data.data.total_count / API_LIMIT)\n        });\n      }\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    console.log(\"Catch\", err);\n  });\n};\nexport const getCustomerDetailsApi = (id, ctx) => {\n  let data = new URLSearchParams();\n  data.append(\"customer_id\", id);\n  postLoginInstance.post(\"/organisation/user/get-customer-details\", data).then(res => {\n    if (!res.data.error) {\n      ctx.setState({\n        customerData: res.data.data\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    console.log(\"Catch\", err);\n  });\n};\nexport const addRewardsApi = (data, cb) => {\n  return postLoginInstance.post(\"/organisation/user/add-customer-reward\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      toast.success(res.data.message || \"Rewards added.\");\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    toast.error(err.message || \"Something went wrong\");\n  });\n};\nexport const getRewardsByCustomerApi = (id, ctx) => {\n  let data = new URLSearchParams();\n  data.append(\"user_id\", id);\n  return postLoginInstance.post(\"organisation/user/get-reward-history-by-user\", data).then(res => {\n    if (!res.data.error) {\n      // cb()\n      console.log(\"res\", res);\n      ctx.setState({\n        customerRewardList: res.data.data.results,\n        totalPages: Math.ceil(res.data.data.total_count / API_LIMIT)\n      }); // toast.success(res.data.message || \"Rewards added.\")\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    toast.error(err.message || \"Something went wrong\");\n  });\n};\nexport const updateCustomerStatusApi = (data, ctx) => {\n  return postLoginInstance.post(\"organisation/user/activate-deactivate-customer\", data).then(res => {\n    if (!res.data.error) {\n      getAllCustomersApi(ctx);\n      toast.success(res.data.message || \"Updated\");\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(err => {\n    toast.error(err.message || \"Something went wrong\");\n  });\n};","map":{"version":3,"sources":["/opt/projects/loch-dashboard/src/app/customers/Api.js"],"names":["toast","postLoginInstance","API_LIMIT","START_PAGE","addUpdateCustomerApi","data","cb","post","then","res","error","success","message","catch","err","getAllCustomersApi","ctx","optionsList","customerInfo","console","log","searchText","searchKey","state","page","URLSearchParams","append","JSON","stringify","key","value","phoneNumberOptions","results","map","item","label","mobile","id","selectedCustomer","filter","user_details","setState","showAddCustomer","phoneNumber","customersList","totalPages","Math","ceil","total_count","getCustomerDetailsApi","customerData","addRewardsApi","getRewardsByCustomerApi","customerRewardList","updateCustomerStatusApi"],"mappings":"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","sourcesContent":["import { toast } from \"react-toastify\"\nimport { postLoginInstance } from \"../../utils\"\nimport { API_LIMIT, START_PAGE } from \"../../utils/Constant\"\n\nexport const addUpdateCustomerApi = (data, cb) => {\n  postLoginInstance\n    .post(\"/organisation/user/add-update-customer\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        toast.success(res.data.message || \"Something went wrong\")\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      toast.error(err.message || \"Something went wrong\")\n    })\n}\n\nexport const getAllCustomersApi = (\n  ctx,\n  optionsList = false,\n  customerInfo = null\n) => {\n  console.log(\"customerInfo\", customerInfo)\n  const { searchText, searchKey } = ctx.state\n  console.log(\"ctx.state.page * API_LIMIT\", ctx.state.page)\n  let data = new URLSearchParams()\n  if (optionsList) {\n    data.append(\"start\", -1)\n    data.append(\"limit\", -1)\n  } else {\n    data.append(\"start\", (ctx.state.page - 1) * API_LIMIT || START_PAGE)\n    data.append(\"limit\", API_LIMIT)\n  }\n  // data.append(\"start\", (ctx.state.page - 1) * API_LIMIT);\n  // data.append(\"limit\", API_LIMIT);\n  data.append(\n    \"conditions\",\n    JSON.stringify(searchText ? [{ key: searchKey, value: searchText }] : [])\n  )\n  data.append(\"sorts\", JSON.stringify([]))\n  postLoginInstance\n    .post(\"/organisation/user/search-customer\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        let phoneNumberOptions = res.data.data.results.map((item) => ({\n          ...item,\n          label: item.mobile || \"Null\",\n          value: item.id\n        }))\n        const selectedCustomer = customerInfo\n          ? phoneNumberOptions.filter(\n              (item) => item.id === customerInfo.user_details.id\n            )\n          : \"\"\n        if (optionsList) {\n          ctx.setState({\n            phoneNumberOptions,\n            ...(customerInfo && {\n              customerInfo: customerInfo.user_details,\n              showAddCustomer: false,\n              phoneNumber: customerInfo.user_details.id,\n              selectedCustomer\n            })\n          })\n        } else {\n          ctx.setState({\n            customersList: res.data.data.results,\n            totalPages: Math.ceil(res.data.data.total_count / API_LIMIT)\n          })\n        }\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      console.log(\"Catch\", err)\n    })\n}\n\nexport const getCustomerDetailsApi = (id, ctx) => {\n  let data = new URLSearchParams()\n  data.append(\"customer_id\", id)\n  postLoginInstance\n    .post(\"/organisation/user/get-customer-details\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        ctx.setState({\n          customerData: res.data.data\n        })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      console.log(\"Catch\", err)\n    })\n}\n\nexport const addRewardsApi = (data, cb) => {\n  return postLoginInstance\n    .post(\"/organisation/user/add-customer-reward\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        toast.success(res.data.message || \"Rewards added.\")\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      toast.error(err.message || \"Something went wrong\")\n    })\n}\n\nexport const getRewardsByCustomerApi = (id, ctx) => {\n  let data = new URLSearchParams()\n  data.append(\"user_id\", id)\n  return postLoginInstance\n    .post(\"organisation/user/get-reward-history-by-user\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        // cb()\n        console.log(\"res\", res)\n        ctx.setState({\n          customerRewardList: res.data.data.results,\n          totalPages: Math.ceil(res.data.data.total_count / API_LIMIT)\n        })\n        // toast.success(res.data.message || \"Rewards added.\")\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      toast.error(err.message || \"Something went wrong\")\n    })\n}\n\nexport const updateCustomerStatusApi = (data, ctx) => {\n  return postLoginInstance\n    .post(\"organisation/user/activate-deactivate-customer\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        getAllCustomersApi(ctx)\n        toast.success(res.data.message || \"Updated\")\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((err) => {\n      toast.error(err.message || \"Something went wrong\")\n    })\n}\n"]},"metadata":{},"sourceType":"module"}