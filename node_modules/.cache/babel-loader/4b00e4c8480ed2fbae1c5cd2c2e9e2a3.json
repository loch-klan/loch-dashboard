{"ast":null,"code":"import moment from \"moment\";\nimport { toast } from \"react-toastify\";\nimport { postLoginInstance, preLoginInstance } from \"../../utils\";\nimport { API_LIMIT, START_PAGE } from \"../../utils/Constant\";\nimport { calculateTotalPageCount } from \"../../utils/ReusableFunctions\";\nexport const getOrdersApi = function (ctx) {\n  let page = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : START_PAGE;\n  let data = new URLSearchParams();\n  data.append(\"start\", page * API_LIMIT || START_PAGE);\n  data.append(\"limit\", API_LIMIT);\n  data.append(\"conditions\", JSON.stringify(ctx.state.conditions || []));\n  data.append(\"sorts\", JSON.stringify([{\n    key: \"SORT_BY_CREATED_ON\",\n    value: false\n  }]));\n  return postLoginInstance.post(\"/commerce/order/search-order\", data).then(res => {\n    if (!res.data.error) {\n      ctx.setState({\n        bookingsList: res.data.data.results,\n        totalCount: res.data.data.total_count,\n        totalPage: calculateTotalPageCount(res.data.data.total_count),\n        page: page\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const getBookingDetailsApi = (id, ctx) => {\n  const data = new URLSearchParams();\n  data.append(\"order_id\", id);\n  return postLoginInstance.post(\"commerce/order/get-order-details-by-id\", data).then(res => {\n    if (!res.data.error) {\n      ctx.setState({\n        bookingData: res.data.data.order\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const cancelOrderApi = (bookingId, reason, cb, handleClose) => {\n  const data = new URLSearchParams();\n  data.append(\"order_id\", bookingId);\n  data.append(\"cancellation_reason\", reason);\n  return postLoginInstance.post(\"commerce/order/cancel-order\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      handleClose();\n      toast.success(res.data.message || \"Order Cancelled Successfully\");\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const getVehiclesForOrderApi = (id, ctx) => {\n  const data = new URLSearchParams();\n  data.append(\"order_id\", id);\n  data.append(\"start\", -1);\n  data.append(\"limit\", -1);\n  return postLoginInstance.post(\"commerce/order/get-vehicles-for-order\", data).then(res => {\n    if (!res.data.error) {\n      let vehicleOptions = res.data.data.results.map(item => ({\n        label: item.name + \" - \" + item.registration_no,\n        value: item.id\n      }));\n      ctx.setState({\n        vehicleOptions: vehicleOptions\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const reassignVehicleOrderApi = (bookingId, bikeId, cb, handleClose) => {\n  const data = new URLSearchParams();\n  data.append(\"order_id\", bookingId);\n  data.append(\"vehicle_id\", bikeId);\n  return postLoginInstance.post(\"commerce/order/reassign-vehicle-on-order\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      handleClose();\n      toast.success(res.data.message);\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const markPickupOrderApi = (bookingId, cb, handleClose) => {\n  const data = new URLSearchParams();\n  data.append(\"order_id\", bookingId);\n  return postLoginInstance.post(\"commerce/order/mark-order-for-pickup\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      handleClose();\n      toast.success(res.data.message);\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const markReturnOrderApi = (bookingId, paymentMode, cb, handleClose) => {\n  const data = new URLSearchParams();\n  data.append(\"order_id\", bookingId);\n  data.append(\"payment_mode\", paymentMode);\n  return postLoginInstance.post(\"commerce/order/mark-order-for-return\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      handleClose();\n      toast.success(res.data.message);\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const addPenaltyApi = (data, cb, handleClose) => {\n  return postLoginInstance.post(\"commerce/order/add-update-penalty-details\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n      handleClose();\n      toast.success(res.data.message);\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const addPenaltyDetailsApi = (data, ctx) => {\n  return postLoginInstance.post(\"commerce/order/get-penalty-details\", data).then(res => {\n    if (!res.data.error) {\n      ctx.setState({\n        pentaltyDetails: res.data.data.extra_charges\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const getExtendBookingPricingApi = (extendDate, props, toggleStatus, handleExtend) => {\n  const data = new URLSearchParams();\n  data.append(\"order_id\", props.orderId);\n  data.append(\"end_datetime\", moment(extendDate).format(\"DD-MM-YYYY hh:mm\"));\n  return postLoginInstance.post(\"commerce/order/get-pricing-for-extend-order\", data).then(res => {\n    if (!res.data.error) {\n      handleExtend({ ...res.data.data,\n        extendDate\n      });\n    } else {\n      toggleStatus(true);\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    console.log(\" error: \", error);\n  });\n};\nexport const extendOrderApi = (data, props) => {\n  // return function (dispatch, getState) {\n  return postLoginInstance.post(\"commerce/order/extend-order\", data).then(res => {\n    if (!res.data.error) {\n      //  console.log('res',res);\n      props.handleClose();\n      props.getBookingDetails();\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    toast.error(error.message || \"Something went wrong\");\n  }); // }\n};\nexport const getAvailableVehiclesApi = (data, ctx) => {\n  // return function (dispatch, getState) {\n  return postLoginInstance.post(\"offering/vehicle/get-available-vehicles\", data).then(res => {\n    if (!res.data.error) {\n      //  console.log('res',res);\n      const bikeList = res.data.data.results.map(item => ({ ...item,\n        label: item.model_info.model_name + \" - \" + item.registration_no,\n        value: item.id\n      }));\n      ctx.setState({\n        bikeList\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    toast.error(error.message || \"Something went wrong\");\n  }); // }\n};\nexport const createOrderApi = (data, ctx) => {\n  // return function (dispatch, getState) {\n  return postLoginInstance.post(\"commerce/order/create-order\", data).then(res => {\n    if (!res.data.error) {\n      // console.log('res',res);\n      ctx.props.history.push(\"/booking-management\");\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    toast.error(error.message || \"Something went wrong\");\n  }); // }\n};\nexport const sendOtpApi = (ctx, data) => {\n  preLoginInstance.post(\"/organisation/user/send-otp\", data).then(res => {\n    if (!res.data.error) {\n      console.log(\"res\", res);\n      ctx.setState({\n        showVerifyOtp: true\n      });\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n      ctx.setState({\n        errorMessage: res.data.message || \"Invalid Credentials\"\n      });\n    }\n  }).catch(err => {\n    ctx.setState({\n      errorMessage: \"Something went wrong\"\n    });\n  });\n};\nexport const verifyOtpApi = (ctx, data) => {\n  preLoginInstance.post(\"/organisation/user/verify-otp\", data).then(res => {\n    if (!res.data.error) {\n      console.log(\"res\", res);\n      ctx.props.handleAddCustomer(res.data.data);\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n      ctx.setState({\n        errorMessage: res.data.message || \"Invalid Credentials\"\n      });\n    }\n  }).catch(err => {\n    ctx.setState({\n      errorMessage: \"Something went wrong\"\n    });\n  });\n};\nexport const addUpdateKYCApi = (data, cb) => {\n  return postLoginInstance.post(\"commerce/order/add-update-kyc-details\", data).then(res => {\n    if (!res.data.error) {\n      cb();\n    } else {\n      toast.error(res.data.message || \"Something went wrong\");\n    }\n  }).catch(error => {\n    toast.error(error.message || \"Something went wrong\");\n  });\n};","map":{"version":3,"sources":["/opt/projects/loch-dashboard/src/app/bookingManagement/Api.js"],"names":["moment","toast","postLoginInstance","preLoginInstance","API_LIMIT","START_PAGE","calculateTotalPageCount","getOrdersApi","ctx","page","data","URLSearchParams","append","JSON","stringify","state","conditions","key","value","post","then","res","error","setState","bookingsList","results","totalCount","total_count","totalPage","message","catch","console","log","getBookingDetailsApi","id","bookingData","order","cancelOrderApi","bookingId","reason","cb","handleClose","success","getVehiclesForOrderApi","vehicleOptions","map","item","label","name","registration_no","reassignVehicleOrderApi","bikeId","markPickupOrderApi","markReturnOrderApi","paymentMode","addPenaltyApi","addPenaltyDetailsApi","pentaltyDetails","extra_charges","getExtendBookingPricingApi","extendDate","props","toggleStatus","handleExtend","orderId","format","extendOrderApi","getBookingDetails","getAvailableVehiclesApi","bikeList","model_info","model_name","createOrderApi","history","push","sendOtpApi","showVerifyOtp","errorMessage","err","verifyOtpApi","handleAddCustomer","addUpdateKYCApi"],"mappings":"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","sourcesContent":["import moment from \"moment\"\nimport { toast } from \"react-toastify\"\nimport { postLoginInstance, preLoginInstance } from \"../../utils\"\nimport { API_LIMIT, START_PAGE } from \"../../utils/Constant\"\nimport { calculateTotalPageCount } from \"../../utils/ReusableFunctions\"\n\nexport const getOrdersApi = (ctx, page = START_PAGE) => {\n  let data = new URLSearchParams()\n  data.append(\"start\", page * API_LIMIT || START_PAGE)\n  data.append(\"limit\", API_LIMIT)\n  data.append(\"conditions\", JSON.stringify(ctx.state.conditions || []))\n  data.append(\n    \"sorts\",\n    JSON.stringify([{ key: \"SORT_BY_CREATED_ON\", value: false }])\n  )\n\n  return postLoginInstance\n    .post(\"/commerce/order/search-order\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        ctx.setState({\n          bookingsList: res.data.data.results,\n          totalCount: res.data.data.total_count,\n          totalPage: calculateTotalPageCount(res.data.data.total_count),\n          page: page\n        })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const getBookingDetailsApi = (id, ctx) => {\n  const data = new URLSearchParams()\n  data.append(\"order_id\", id)\n  return postLoginInstance\n    .post(\"commerce/order/get-order-details-by-id\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        ctx.setState({ bookingData: res.data.data.order })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const cancelOrderApi = (bookingId, reason, cb, handleClose) => {\n  const data = new URLSearchParams()\n  data.append(\"order_id\", bookingId)\n  data.append(\"cancellation_reason\", reason)\n  return postLoginInstance\n    .post(\"commerce/order/cancel-order\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        handleClose()\n        toast.success(res.data.message || \"Order Cancelled Successfully\")\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const getVehiclesForOrderApi = (id, ctx) => {\n  const data = new URLSearchParams()\n  data.append(\"order_id\", id)\n  data.append(\"start\", -1)\n  data.append(\"limit\", -1)\n  return postLoginInstance\n    .post(\"commerce/order/get-vehicles-for-order\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        let vehicleOptions = res.data.data.results.map((item) => ({\n          label: item.name + \" - \" + item.registration_no,\n          value: item.id\n        }))\n        ctx.setState({ vehicleOptions: vehicleOptions })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const reassignVehicleOrderApi = (bookingId, bikeId, cb, handleClose) => {\n  const data = new URLSearchParams()\n  data.append(\"order_id\", bookingId)\n  data.append(\"vehicle_id\", bikeId)\n  return postLoginInstance\n    .post(\"commerce/order/reassign-vehicle-on-order\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        handleClose()\n        toast.success(res.data.message)\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const markPickupOrderApi = (bookingId, cb, handleClose) => {\n  const data = new URLSearchParams()\n  data.append(\"order_id\", bookingId)\n  return postLoginInstance\n    .post(\"commerce/order/mark-order-for-pickup\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        handleClose()\n        toast.success(res.data.message)\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const markReturnOrderApi = (bookingId, paymentMode, cb, handleClose) => {\n  const data = new URLSearchParams()\n  data.append(\"order_id\", bookingId)\n  data.append(\"payment_mode\", paymentMode)\n  return postLoginInstance\n    .post(\"commerce/order/mark-order-for-return\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        handleClose()\n        toast.success(res.data.message)\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const addPenaltyApi = (data, cb, handleClose) => {\n  return postLoginInstance\n    .post(\"commerce/order/add-update-penalty-details\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n        handleClose()\n        toast.success(res.data.message)\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const addPenaltyDetailsApi = (data, ctx) => {\n  return postLoginInstance\n    .post(\"commerce/order/get-penalty-details\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        ctx.setState({\n          pentaltyDetails: res.data.data.extra_charges\n        })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const getExtendBookingPricingApi = (\n  extendDate,\n  props,\n  toggleStatus,\n  handleExtend\n) => {\n  const data = new URLSearchParams()\n  data.append(\"order_id\", props.orderId)\n  data.append(\"end_datetime\", moment(extendDate).format(\"DD-MM-YYYY hh:mm\"))\n  return postLoginInstance\n    .post(\"commerce/order/get-pricing-for-extend-order\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        handleExtend({ ...res.data.data, extendDate })\n      } else {\n        toggleStatus(true)\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      console.log(\" error: \", error)\n    })\n}\n\nexport const extendOrderApi = (data, props) => {\n  // return function (dispatch, getState) {\n  return postLoginInstance\n    .post(\"commerce/order/extend-order\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        //  console.log('res',res);\n        props.handleClose()\n        props.getBookingDetails()\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      toast.error(error.message || \"Something went wrong\")\n    })\n  // }\n}\n\nexport const getAvailableVehiclesApi = (data, ctx) => {\n  // return function (dispatch, getState) {\n  return postLoginInstance\n    .post(\"offering/vehicle/get-available-vehicles\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        //  console.log('res',res);\n        const bikeList = res.data.data.results.map((item) => ({\n          ...item,\n          label: item.model_info.model_name + \" - \" + item.registration_no,\n          value: item.id\n        }))\n        ctx.setState({ bikeList })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      toast.error(error.message || \"Something went wrong\")\n    })\n  // }\n}\n\nexport const createOrderApi = (data, ctx) => {\n  // return function (dispatch, getState) {\n  return postLoginInstance\n    .post(\"commerce/order/create-order\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        // console.log('res',res);\n        ctx.props.history.push(\"/booking-management\")\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      toast.error(error.message || \"Something went wrong\")\n    })\n  // }\n}\n\nexport const sendOtpApi = (ctx, data) => {\n  preLoginInstance\n    .post(\"/organisation/user/send-otp\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        console.log(\"res\", res)\n        ctx.setState({ showVerifyOtp: true })\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n        ctx.setState({\n          errorMessage: res.data.message || \"Invalid Credentials\"\n        })\n      }\n    })\n    .catch((err) => {\n      ctx.setState({\n        errorMessage: \"Something went wrong\"\n      })\n    })\n}\n\nexport const verifyOtpApi = (ctx, data) => {\n  preLoginInstance\n    .post(\"/organisation/user/verify-otp\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        console.log(\"res\", res)\n        ctx.props.handleAddCustomer(res.data.data)\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n        ctx.setState({\n          errorMessage: res.data.message || \"Invalid Credentials\"\n        })\n      }\n    })\n    .catch((err) => {\n      ctx.setState({\n        errorMessage: \"Something went wrong\"\n      })\n    })\n}\n\nexport const addUpdateKYCApi = (data, cb) => {\n  return postLoginInstance\n    .post(\"commerce/order/add-update-kyc-details\", data)\n    .then((res) => {\n      if (!res.data.error) {\n        cb()\n      } else {\n        toast.error(res.data.message || \"Something went wrong\")\n      }\n    })\n    .catch((error) => {\n      toast.error(error.message || \"Something went wrong\")\n    })\n}\n"]},"metadata":{},"sourceType":"module"}